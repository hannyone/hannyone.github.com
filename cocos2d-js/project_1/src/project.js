require=function e(t,i,l){function a(o,r){if(!i[o]){if(!t[o]){var s="function"==typeof require&&require;if(!r&&s)return s(o,!0);if(f)return f(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){var i=t[o][1][e];return a(i?i:e)},d,d.exports,e,t,i,l)}return i[o].exports}for(var f="function"==typeof require&&require,o=0;o<l.length;o++)a(l[o]);return a}({Main:[function(e,t,i){"use strict";cc._RFpush(t,"c3e3fhd2P9Al6wWyp5tYOhi","Main"),cc.Class({"extends":cc.Component,properties:{blockEdgeLength:60,fieldMapLRMargin:20,fieldMapTBMargin:30,blockTypeCount:7,fieldMapRow:15,fieldMapColumn:10,fieldMapText:{"default":null,type:cc.Object},fieldMapImage:{"default":null,type:cc.Node},Background:{"default":null,type:cc.Node},ArrowR:{"default":null,type:cc.Node},ArrowL:{"default":null,type:cc.Node},ArrowD:{"default":null,type:cc.Node},ArrowRU:{"default":null,type:cc.Node},ArrowLU:{"default":null,type:cc.Node},CurrentBlock:{"default":null,type:cc.Node},Block:{"default":null,type:cc.Prefab},BlockT:{"default":null,type:cc.Prefab},BlockI:{"default":null,type:cc.Prefab},BlockO:{"default":null,type:cc.Prefab},BlockL:{"default":null,type:cc.Prefab},BlockRL:{"default":null,type:cc.Prefab},BlockS:{"default":null,type:cc.Prefab},BlockRS:{"default":null,type:cc.Prefab}},onLoad:function(){var e=this;this.fieldMapText=[],this.fieldMapImage=[];for(var t=0;t<this.fieldMapRow+2;t++){this.fieldMapText.push([]),this.fieldMapImage.push([]);for(var i=0;i<this.fieldMapColumn+2;i++)0===t||t===this.fieldMapRow+1?this.fieldMapText[t].push(9):0===i||i===this.fieldMapColumn+1?this.fieldMapText[t].push(9):this.fieldMapText[t].push(0),this.fieldMapImage.push(),t>0&&t<this.fieldMapRow+1&&i>0&&i<this.fieldMapColumn+1&&(this.fieldMapImage[t][i]=cc.instantiate(this.Block),this.fieldMapImage[t][i].setPosition(cc.p((i-1)*this.blockEdgeLength+this.fieldMapLRMargin,(t-1)*this.blockEdgeLength+this.fieldMapTBMargin)))}this.ArrowR.on(cc.Node.EventType.TOUCH_START,function(t){e.moveRight()}),this.ArrowL.on(cc.Node.EventType.TOUCH_START,function(t){e.moveLeft()}),this.ArrowD.on(cc.Node.EventType.TOUCH_START,function(t){e.pullDownBlock()}),this.ArrowRU.on(cc.Node.EventType.TOUCH_START,function(t){e.CurrentBlock.rotation+=90}),this.ArrowLU.on(cc.Node.EventType.TOUCH_START,function(t){e.CurrentBlock.rotation-=90})},getBlockStartPosition:function(){return 1===this.currentblockNum?cc.p(this.fieldMapLRMargin+this.blockEdgeLength*(this.fieldMapColumn/2),this.blockEdgeLength*this.fieldMapRow-this.fieldMapTBMargin):cc.p(this.fieldMapLRMargin+this.blockEdgeLength*(this.fieldMapColumn/2),this.blockEdgeLength*(this.fieldMapRow-1)-this.fieldMapTBMargin)},getBlockNum:function(){return Math.floor(Math.random()*this.blockTypeCount)},createBlockText:function(){switch(this.currentblockNum=this.getBlockNum(),this.currentblockNum){case 0:this.fieldMapText[15][5]=1,this.fieldMapText[14][4]=1,this.fieldMapText[14][5]=1,this.fieldMapText[14][6]=1;break;case 1:this.fieldMapText[15][3]=1,this.fieldMapText[15][4]=1,this.fieldMapText[15][5]=1,this.fieldMapText[15][6]=1;break;case 2:this.fieldMapText[15][5]=1,this.fieldMapText[15][6]=1,this.fieldMapText[14][5]=1,this.fieldMapText[14][6]=1;break;case 3:this.fieldMapText[15][6]=1,this.fieldMapText[14][4]=1,this.fieldMapText[14][5]=1,this.fieldMapText[14][6]=1;break;case 4:this.fieldMapText[15][4]=1,this.fieldMapText[14][4]=1,this.fieldMapText[14][5]=1,this.fieldMapText[14][6]=1;break;case 5:this.fieldMapText[15][5]=1,this.fieldMapText[15][6]=1,this.fieldMapText[14][4]=1,this.fieldMapText[14][5]=1;break;case 6:this.fieldMapText[15][4]=1,this.fieldMapText[15][5]=1,this.fieldMapText[14][5]=1,this.fieldMapText[14][6]=1}this.drawBlocks(),console.log(this.fieldMapText)},drawBlocks:function(){for(var e=1;e<=this.fieldMapRow;e++)for(var t=1;t<=this.fieldMapColumn;t++)this.fieldMapText[e][t]>0?this.fieldMapImage[e][t].parent=cc.director.getScene():this.fieldMapImage[e][t].parent=null},start:function(){this.createBlockText(),this.schedule(this.blockDownCallback,1)},blockDownCallback:function(e){this.pullDownBlock()},pullDownBlock:function(){for(var e=!1,t=0,i=1;i<=this.fieldMapRow;i++){for(var l=1;l<=this.fieldMapColumn;l++)if(1===this.fieldMapText[i][l]){if(t++,this.fieldMapText[i-1][l]>1){e=!0;break}if(4===t)break}if(4===t)break}t=0;for(var i=1;i<=this.fieldMapRow;i++){for(var l=1;l<=this.fieldMapColumn&&(1!==this.fieldMapText[i][l]||(t++,e?this.fieldMapText[i][l]=2:(this.fieldMapText[i][l]=0,this.fieldMapText[i-1][l]=1),4!==t));l++);if(4===t)break}e?this.createBlockText():this.drawBlocks()},moveLeft:function(){for(var e=!1,t=0,i=1;i<=this.fieldMapRow;i++){for(var l=1;l<=this.fieldMapColumn;l++)if(1===this.fieldMapText[i][l]){if(t++,this.fieldMapText[i][l-1]>1){e=!0;break}if(4===t)break}if(4===t)break}t=0;for(var i=1;i<=this.fieldMapRow;i++){for(var l=1;l<=this.fieldMapColumn&&(1!==this.fieldMapText[i][l]||(t++,e||(this.fieldMapText[i][l]=0,this.fieldMapText[i][l-1]=1),4!==t));l++);if(4===t)break}e||this.drawBlocks()},moveRight:function(){for(var e=!1,t=0,i=1;i<=this.fieldMapRow;i++){for(var l=this.fieldMapColumn;l>=1;l--)if(1===this.fieldMapText[i][l]){if(t++,this.fieldMapText[i][l+1]>1){e=!0;break}if(4===t)break}if(4===t)break}t=0;for(var i=1;i<=this.fieldMapRow;i++){for(var l=this.fieldMapColumn;l>=1&&(1!==this.fieldMapText[i][l]||(t++,e||(this.fieldMapText[i][l]=0,this.fieldMapText[i][l+1]=1),4!==t));l--);if(4===t)break}e||this.drawBlocks()}}),cc._RFpop()},{}]},{},["Main"]);
//# sourceMappingURL=project.js.map